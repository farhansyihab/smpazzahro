<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/icons/48.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SMP AZZAHRO Palembang</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
    <script type="text/javascript">
      function loadFile(filePath) {
          // Create a <script> tag, set its source
          let scriptTag = document.createElement('script');
  
          // And listen to it
          scriptTag.onload = function (loadEvent) {
              // This function is an event handler of the script tag
              try {
                ambilData();
              } catch (e) {
                // console.log(`ada masalah pada ${e}`)
                return false ;
              } finally {
  
              }
          }
          scriptTag.type = 'text/javascript';
          scriptTag.src = filePath ;
  
          // Finally add it to the <head>
          document.getElementsByTagName('head')[0].appendChild(scriptTag);
      }
  
      function ambilData(jsonData){
        const penyimpanan   = window.localStorage;
        const entries       = jsonData.feed.entry;
        const contentData   = entries.map(entry => {
        return {
          id: entry.id.$t,
          title: entry.title.$t,
          content: entry.content.$t
        }
      })
      if(contentData.length > 1) {
        const strContent = JSON.stringify(contentData) ;
        // console.log(strContent)
        penyimpanan.setItem("dataInfo", strContent);
      }
  
      }
  
      // Usage
      let online    = navigator.onLine;
      const jsonURL = "https://smkazzahropalembang.blogspot.com/feeds/posts/default?alt=json-in-script&callback=ambilData";
      if(online == true){
          loadFile(jsonURL);
      }else{
        // console.log("Sedang tidak online")
      }
  
      </script>	
  </body>
</html>
